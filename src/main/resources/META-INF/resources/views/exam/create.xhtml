<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
<ui:composition template="../common/template.xhtml">
    <ui:define name="content">

        <h1 >#{dictionary['Create.new.definition']}</h1>
        <h:form id="mainForm" >
            #{dictionary['Exam.name']} <br/>
            <p:inputText id="examNameInput" value="#{examCreator.examName}"
                         style="width:100%"
                         name="name"/>
            <br/>
            #{dictionary['Questions']}
            <p:outputPanel id="questions">

                <p:dataTable value="#{examCreator.questions}" var="question">
                    <p:column style="width: 90%" >
                        <p:inputTextarea cols="80" rows="1" value="#{question.question}"/>
                        <p:commandButton style="float:right;" value="#{dictionary['Add.answer']}"
                                         update="answers"
                                         actionListener="#{examCreator.addQuestionAnswer(question)}"></p:commandButton>
                        <br/>
                        #{dictionary['Time.for.question']}:
                        <p:inputNumber id="secondsForQuestion" size="2"
                                       value="#{question.secondsForAnswer}" symbol="s"
                                       symbolPosition="s" decimalPlaces="0">
                        </p:inputNumber>
                        <p:outputPanel id="answers">
                            <ui:repeat value="#{question.answers}" var="answer">
                                <p:inputTextarea cols="80" rows="1" id="answer" value="#{answer.answer}">
                                    <p:ajax event="blur" update="@this"/>
                                </p:inputTextarea>
                                #{dictionary['Is.valid']}:
                                <p:selectBooleanCheckbox value="#{answer.valid}">
                                    <p:ajax update="@parent:@parent:answers"
                                            listener="#{examCreator.selectAnswer(question, answer)}"/>
                                </p:selectBooleanCheckbox>

                                <p:commandButton style="float:right"
                                                 update="@parent:@parent:answers" value="#{dictionary['Remove']}"
                                                 actionListener="#{examCreator.removeAnswer(question, answer)}"></p:commandButton>
                                <br/>
                            </ui:repeat>
                        </p:outputPanel>

                    </p:column>
                    <p:column>
                        <p:commandButton update=":mainForm:questions" value="#{dictionary['Remove']}"
                                         actionListener="#{examCreator.removeQuestion(question)}"></p:commandButton>
                    </p:column>
                </p:dataTable>
            </p:outputPanel>
            <p:commandButton update="questions" value="#{dictionary['Add.question']}"
                             actionListener="#{examCreator.addQuestion()}"></p:commandButton>
            <p:messages id="messages" showDetail="true" closable="true"/>
            <p:commandButton value="#{dictionary['Save']}" update="messages"
                             actionListener="#{examCreator.save()}"></p:commandButton>
        </h:form>
    </ui:define>
</ui:composition>
</html>
